{"version":3,"sources":["webpack:///C:/Users/will/Documents/GitHub/reference/美信拓扑即时通讯 IM SDK，为 App 添加聊天功能示例/pages/group/message/index.vue?8bf0","webpack:///C:/Users/will/Documents/GitHub/reference/美信拓扑即时通讯 IM SDK，为 App 添加聊天功能示例/pages/group/message/index.vue?b7a2","webpack:///C:/Users/will/Documents/GitHub/reference/美信拓扑即时通讯 IM SDK，为 App 添加聊天功能示例/pages/group/message/index.vue?2c67","webpack:///C:/Users/will/Documents/GitHub/reference/美信拓扑即时通讯 IM SDK，为 App 添加聊天功能示例/pages/group/message/index.vue?c05b","uni-app:///pages/group/message/index.vue","webpack:///C:/Users/will/Documents/GitHub/reference/美信拓扑即时通讯 IM SDK，为 App 添加聊天功能示例/pages/group/message/index.vue?d794","webpack:///C:/Users/will/Documents/GitHub/reference/美信拓扑即时通讯 IM SDK，为 App 添加聊天功能示例/pages/group/message/index.vue?55b1","uni-app:///main.js"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACa;;;AAGjE;AACgM;AAChM,gBAAgB,2LAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAmvB,CAAgB,qrBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACqCvwB;AACA,2F;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAHA;AACA;gBAIA,EACA,IADA,kBACA,CACA,SACA,OADA,EAEA,YAFA,EAGA,UAHA,EAIA,cAJA,EAKA,WALA,EAMA,OANA,EAOA,eAPA,EAQA,cARA,EASA,SATA,EAUA,SAVA,EAWA,cAXA,EAYA,QAZA,EAaA,cAbA,EAcA,QAdA,EAeA,UAfA,EAgBA,QAhBA,EAiBA,UAjBA,GAmBA,CArBA,EAuBA,cAvBA,EAwBA,SACA,WACA,YADA,EAEA;AACA,+CAHA,EADA,EAxBA,EA+BA,qCACA,2BACA,0BAFA,CAEA;AACA,qCACA,wBACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gCADA;AAEA,2CAFA;;AAIA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,mBADA;;AAGA;;AAEA;AACA;AACA;AACA;AACA,oBADA;AAEA,uBAFA;;AAIA;AACA;;AAEA;AACA;AACA;AACA,gBADA;;AAGA;AACA;AACA,oBADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA5DA;;AA8DA,aA9DA,GA8DA,OA9DA,CA8DA,SA9DA;AA+DA;AACA;AACA,2BADA;AAEA,2BAFA;AAGA,kCAHA;;AAKA;AACA,oBADA;AAEA,cAFA;AAGA,wBAHA;AAIA,oBAJA;AAKA,gBALA;AAMA,oBANA;AAOA,sBAPA;AAQA,cARA;AASA,sBATA;AAUA,4BAVA;AAWA,gBAXA;AAYA,gBAZA;AAaA,gBAbA;;AAeA,GAnHA;AAoHA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GA9HA;AA+HA;AACA;AACA,2DADA,CACA;;AAEA;AACA;AACA;AACA;AACA,qBADA;;AAGA;AACA;AACA;AACA,SAFA,EAEA,kCAFA;AAGA,OAJA;AAKA;AACA;AACA,wBADA;;AAGA,OAJA;AAKA;AACA;AACA,wBADA;;AAGA,OAJA;AAKA;AACA,KA1BA;;AA4BA,iBA5BA,2BA4BA;AACA;AACA;AACA,+DADA;;AAGA;AACA,KAlCA,CAkCA;AAlCA,GA/HA,E;;;;;;;;;;;;ACxCA;AAAA;AAAA;AAAA;AAAgkC,CAAgB,s8BAAG,EAAC,C;;;;;;;;;;;ACAplC;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;kDCNL;;;AAGA;AACA,qG,8FAHA;AACAA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC,CAGAC,UAAU,CAACC,cAAD,CAAV,C","file":"pages/group/message/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=6eeebd5e&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/group/message/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=6eeebd5e&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n  <!-- index.wxml -->\n  <view>\n    <view class=\"time\">\n      <text>{{ time }}</text>\n    </view>\n    <view class=\"msgcontainer\">\n      <view :class=\"cls\">\n        <view class=\"rosterInfo\">\n          <image class=\"avatar\" :src=\"avatar\" @tap=\"goUserProfile\"></image>\n        </view>\n        <view class=\"name_frame\" v-if=\"cls == 'roster'\">\n          <text>{{ username }}</text>\n        </view>\n        <view class=\"c_content\">\n          <text v-if=\"type == 'text'\">\n            {{ content }}\n            <br />\n            <text v-if=\"ext\">ext: {{ ext }}</text>\n          </text>\n          <image class=\"cimage\" v-if=\"type == 'image'\" :src=\"attachImage\"></image>\n          <video class=\"cimage\" v-if=\"type == 'video'\" :src=\"video\"></video>\n          <!-- <audio name=\"音频文件\" wx:if=\"{{type == 'image'}}\" author=\"\" src=\"{{audio}}\" class=\"saudio\" controls></audio> -->\n          <view class=\"voice_frmae\" v-if=\"type == 'audio'\" @tap=\"splayAudio\">\n            <image class=\"voice\" v-if=\"playing == false\" src=\"/static/pages/image/voice/stop.png\"></image>\n            <image class=\"voice\" v-if=\"playing == true\" src=\"/static/pages/image/voice/start.png\"></image>\n            <text class=\"voice_duration\">'{{ attach.duration }}</text>\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\n//index.js\n//获取应用实例\nimport { toNumber, numToString } from '../../../third/tools';\nimport moment from '../../../third/moment';\n\nexport default {\n  data() {\n    return {\n      cls: '',\n      username: '',\n      avatar: '',\n      contentType: 0,\n      content: '',\n      ext: '',\n      attachImage: '',\n      videoCover: '',\n      video: '',\n      audio: '',\n      messageType: 0,\n      time: '',\n      playing: false,\n      from: '',\n      attach: '',\n      type: '',\n      toType: ''\n    };\n  },\n\n  components: {},\n  props: {\n    message: {\n      type: Object,\n      // 类型（必填），目前接受的类型包括：String, Number, Boolean, Object, Array, null（表示任意类型）\n      default: () => ({})\n    }\n  },\n  beforeMount: function () {\n    const message = this.message;\n    const im = getApp().getIM(); //FIXME: check im undefined\n    const uid = im.userManage.getUid();\n    const from = message.from;\n    const cls = uid == from ? 'self' : 'roster';\n    const type = message.type;\n    const toType = message.toType;\n    let content = message.content || '';\n    let ext = message.ext || '';\n    let username = '';\n    const fromUserObj = im.rosterManage.getRosterInfo(from);\n\n    let avatar = im.sysManage.getImage({\n      avatar: fromUserObj.avatar,\n      sdefault: '/static/pages/image/r.png'\n    });\n    username = fromUserObj.nick_name || fromUserObj.username || '';\n\n    if (from == uid) {\n      username = '我自己';\n    }\n\n    const attach = message.attach || {};\n    let url = attach.url || '';\n\n    if (url && type === 'image') {\n      url = im.sysManage.getImage({\n        avatar: url\n      });\n    }\n\n    let videoCover = '';\n    if (url && type === 'video') {\n      let tUrl = attach.tUrl || '';\n      videoCover = im.sysManage.getImage({\n        avatar: tUrl,\n        thumbnail: true\n      });\n      url = im.sysManage.getChatFile({ url });\n    }\n\n    if (url && type === 'audio') {\n      // 1. use the audio url;\n      let audio = im.sysManage.getAudio({\n        url\n      });\n      console.log('getAudio: ', audio);\n      this.setData({\n        audio\n      }); // 2. download audio to local file\n      // const that = this;\n      // im.sysManage.downloadAudio({url}).then((res) => {\n      //   console.log(\"getAudio: \", res);\n      //   that.setData({\n      //     audio: res,\n      //   });\n      // }).catch((ex) => {\n      //   console.error(\"getAudio error: \", ex);\n      // });\n    }\n\n    let { timestamp } = message;\n    timestamp = toNumber(timestamp);\n    let time = moment(timestamp).calendar('', {\n      sameDay: '[今天] HH:mm',\n      lastDay: '[昨天] HH:mm',\n      sameElse: 'YYYY-MM-DD HH:mm'\n    });\n    this.setData({\n      attach,\n      cls,\n      username,\n      avatar,\n      type,\n      toType,\n      content,\n      ext,\n      attachImage: url,\n      videoCover,\n      video: url,\n      time,\n      from\n    });\n  },\n  onShow: function () {\n    const im = getApp().getIM();\n    const message = this.message;\n\n    // Message displayed as read\n    const fromUid = toNumber(message.from);\n    const uid = im.userManage.getUid();\n    if (fromUid !== uid && message.status !== 'read') {\n      im.groupManage.readGroupMessage(this.uid, this.message.id);\n    }\n  },\n  methods: {\n    splayAudio: function () {\n      const innerAudioContext = wx.createInnerAudioContext(); // innerAudioContext.autoplay = true\n\n      innerAudioContext.obeyMuteSwitch = false;\n      innerAudioContext.loop = false;\n      innerAudioContext.src = this.audio;\n      this.setData({\n        playing: true\n      });\n      innerAudioContext.onPlay(() => {\n        setTimeout(() => {\n          innerAudioContext.stop();\n        }, (this.attach.duration + 3) * 1000);\n      });\n      innerAudioContext.onError((res) => {\n        this.setData({\n          playing: false\n        });\n      });\n      innerAudioContext.onStop((res) => {\n        this.setData({\n          playing: false\n        });\n      });\n      innerAudioContext.play();\n    },\n\n    goUserProfile() {\n      if (this.cls == 'roster') {\n        wx.navigateTo({\n          url: '/pages/profile/userinfo/index?uid=' + this.from\n        });\n      }\n    } ////\n  }\n};\n</script>\n<style>\n@import './index.css';\n</style>\n","import mod from \"-!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1667473764738\n      var cssReload = require(\"C:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/group/message/index.vue'\ncreatePage(Page)"],"sourceRoot":""}