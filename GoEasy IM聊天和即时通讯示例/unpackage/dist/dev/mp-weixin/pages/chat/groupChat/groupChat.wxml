<view class="chatInterface"><image class="group-icon" src="/static/images/group-icon.png" data-event-opts="{{[['tap',[['showMembers',['$event']]]]]}}" bindtap="__e"></image><view class="scroll-view"><view class="all-history-loaded">{{''+(allHistoryLoaded?'已经没有更多的历史消息':'下拉获取历史消息')+''}}</view><checkbox-group data-event-opts="{{[['change',[['selectMessages',['$event']]]]]}}" bindchange="__e"><block wx:for="{{$root.l0}}" wx:for-item="message" wx:for-index="index" wx:key="messageId"><view><view class="time-lag">{{''+message.m0+''}}</view><block wx:if="{{message.$orig.recalled}}"><view class="message-recalled"><block wx:if="{{message.$orig.senderId!==currentUser.uuid}}"><view>{{message.$orig.senderData.name+"撤回了一条消息"}}</view></block><block wx:else><view class="message-recalled-self"><view>你撤回了一条消息</view><block wx:if="{{message.g0}}"><label data-event-opts="{{[['tap',[['editRecalledMessage',['$0'],[[['messages','messageId',message.$orig.messageId,'payload.text']]]]]]]}}" bindtap="__e" class="_span">重新编辑</label></block></view></block></view></block><block wx:else><view class="message-item"><view class="message-item-checkbox"><checkbox hidden="{{!(messageSelector.visible&&message.$orig.status!=='sending')}}" value="{{message.$orig.messageId}}" checked="{{message.g1}}"></checkbox></view><view class="{{['message-item-content',(message.$orig.senderId===currentUser.uuid)?'self':'']}}"><view class="avatar"><image src="{{message.$orig.senderData.avatar}}"></image></view><view data-event-opts="{{[['longpress',[['showActionPopup',['$0',index],[[['messages','messageId',message.$orig.messageId]]]]]]]}}" class="content" bindlongpress="__e"><view class="message-payload"><block wx:if="{{message.$orig.status==='sending'}}"><view class="pending _b"></view></block><block wx:if="{{message.$orig.status==='fail'}}"><view class="send-fail _b"></view></block><block wx:if="{{message.$orig.type==='text'}}"><view><rich-text nodes="{{message.m1}}"></rich-text></view></block><block wx:if="{{message.$orig.type==='image'}}"><image class="image-content" src="{{message.$orig.payload.url}}" data-url="{{message.$orig.payload.url}}" mode="widthFix" data-event-opts="{{[['tap',[['showImageFullScreen',['$event']]]]]}}" bindtap="__e"></image></block><block wx:if="{{message.$orig.type==='video'}}"><view class="video-snapshot" data-url="{{message.$orig.payload.video.url}}" data-event-opts="{{[['tap',[['playVideo',['$event']]]]]}}" bindtap="__e"><image src="{{message.$orig.payload.thumbnail.url}}" mode="aspectFit"></image><view class="video-play-icon"></view></view></block><block wx:if="{{message.$orig.type==='audio'}}"><go-easy-audio-player vue-id="{{'b7361bf6-1-'+index}}" src="{{message.$orig.payload.url}}" duration="{{message.$orig.payload.duration}}" bind:__l="__l"></go-easy-audio-player></block><block wx:if="{{message.$orig.type==='order'}}"><view class="custom-message"><view class="title"><image src="../../../static/images/order.png"></image><text>自定义消息</text></view><view class="custom-message-item">{{"编号："+message.$orig.payload.number}}</view><view class="custom-message-item">{{"商品: "+message.$orig.payload.goods}}</view><view class="custom-message-item">{{"金额: "+message.$orig.payload.price}}</view></view></block></view></view></view></view></block></view></block></checkbox-group></view><block wx:if="{{!videoPlayer.visible&&!messageSelector.visible}}"><view class="action-box"><view class="action-top"><view data-event-opts="{{[['tap',[['switchAudioKeyboard',['$event']]]]]}}" class="{{[audio.visible?'record-icon record-open':'record-icon']}}" bindtap="__e"></view><block wx:if="{{audio.visible}}"><view data-event-opts="{{[['touchstart',[['onRecordStart',['$event']]]],['touchend',[['onRecordEnd',['$event']]]]]}}" class="record-input" bindtouchstart="__e" bindtouchend="__e">{{audio.recording?'松开发送':'按住录音'}}</view></block><block wx:else><view class="message-input"><input type="text" maxlength="700" placeholder="发送消息" data-event-opts="{{[['focus',[['messageInputFocusin',['$event']]]],['input',[['__set_model',['','content','$event',[]]]]]]}}" value="{{content}}" bindfocus="__e" bindinput="__e"/></view></block><view data-event-opts="{{[['tap',[['showEmoji',['$event']]]]]}}" class="file-icon emoji-icon" bindtap="__e"></view><view data-event-opts="{{[['tap',[['showOtherTypesMessagePanel',['$event']]]]]}}" class="file-icon more-icon" bindtap="__e"></view><label data-event-opts="{{[['tap',[['createTextMessage',['$event']]]]]}}" class="send-message-btn _span" bindtap="__e">发送</label></view><block wx:if="{{emoji.visible}}"><view class="action-bottom action-bottom-emoji"><block wx:for="{{emoji.map}}" wx:for-item="emojiItem" wx:for-index="key" wx:key="*this"><image class="emoji-item" src="{{emoji.url+emojiItem}}" data-event-opts="{{[['tap',[['chooseEmoji',[key]]]]]}}" bindtap="__e"></image></block></view></block><block wx:if="{{otherTypesMessagePanelVisible}}"><view class="action-bottom"><view data-event-opts="{{[['tap',[['createImageMessage',['$event']]]]]}}" class="more-item" bindtap="__e"><image src="../../../static/images/tupian.png"></image><text>图片</text></view><view data-event-opts="{{[['tap',[['createVideoMessage',['$event']]]]]}}" class="more-item" bindtap="__e"><image src="../../../static/images/shipin.png"></image><text>视频</text></view><view data-event-opts="{{[['tap',[['showCustomMessageForm',['$event']]]]]}}" class="more-item" bindtap="__e"><image src="../../../static/images/zidingyi.png"></image><text>自定义消息</text></view></view></block></view></block><block wx:if="{{actionPopup.visible}}"><view data-event-opts="{{[['touchmove',[['',['$event']]]]]}}" class="action-popup" catchtouchmove="__e"><view class="layer"></view><view class="action-box"><view data-event-opts="{{[['tap',[['deleteSingleMessage',['$event']]]]]}}" class="action-item" bindtap="__e">删除</view><block wx:if="{{actionPopup.recallable}}"><view data-event-opts="{{[['tap',[['recallMessage',['$event']]]]]}}" class="action-item" bindtap="__e">撤回</view></block><view data-event-opts="{{[['tap',[['showCheckBox',['$event']]]]]}}" class="action-item" bindtap="__e">多选</view><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="action-item" bindtap="__e">取消</view></view></view></block><block wx:if="{{messageSelector.visible}}"><view class="messageSelector-box"><image class="messageSelector-btn" src="/static/images/delete.png" data-event-opts="{{[['tap',[['deleteMultipleMessages',['$event']]]]]}}" bindtap="__e"></image></view></block><block wx:if="{{audio.recording}}"><view class="record-loading"></view></block><block wx:if="{{videoPlayer.visible}}"><video src="{{videoPlayer.url}}" id="videoPlayer" data-event-opts="{{[['fullscreenchange',[['onVideoFullScreenChange',['$event']]]]]}}" bindfullscreenchange="__e"></video></block><block wx:if="{{customMessageFormVisible}}"><custom-message bind:createCustomMessage="__e" bind:closeCustomMessageForm="__e" vue-id="b7361bf6-2" data-event-opts="{{[['^createCustomMessage',[['createCustomMessage']]],['^closeCustomMessageForm',[['closeCustomMessageForm']]]]}}" bind:__l="__l"></custom-message></block></view>